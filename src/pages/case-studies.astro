---
import Layout from '../layouts/Layout.astro';
import HeaderHeroContainer from '../components/sections/HeaderHeroContainer.astro';
import GetInTouch from '../components/sections/GetInTouch.astro';
import Footer from '../components/layout/Footer.astro';
import CaseStudyCard from '../components/cards/CaseStudyCard.astro';
import { getCollection } from 'astro:content';
import cardImage from '../assets/CardImage.svg';

const caseStudies = await getCollection('case-studies');
// Create array with case studies + 2 placeholder cards
const allCards = [...caseStudies];
// Add 2 placeholder entries
while (allCards.length < caseStudies.length + 2) {
  allCards.push(null);
}
---

<Layout title="Case studies">
  <HeaderHeroContainer 
    title="Case studies" 
    subtitle="A brief description of the case studies here and the types of organisations that we work with. Should be no more than two sentences."
    icon="case-studies" 
  />
  <main id="content">
    <section class="section section-light py-10 lg:py-12">
      <div class="container">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 items-stretch">
          {allCards.map((entry, index) => {
            if (entry) {
              const slug = entry.id.replace(/\.md$/, '');
              const firstCategory = entry.data.categories?.[0] || '';
              return (
                <CaseStudyCard
                  category={firstCategory}
                  title={entry.data.title}
                  summary={entry.data.description}
                  imageSrc={cardImage}
                  altText={entry.data.title}
                  linkHref={`/case-studies/${slug}`}
                />
              );
            } else {
              // Placeholder card
              return (
                <CaseStudyCard
                  category="Category"
                  title="Case Study Title"
                  summary="A brief description of the project problem and the process we took to solve it."
                  imageSrc={cardImage}
                  altText="Case study placeholder"
                  linkHref="/case-studies/arc"
                />
              );
            }
          })}
        </div>
      </div>
    </section>
  </main>
  <div class="bg-bg-dark w-full">
    <GetInTouch />
    <Footer />
  </div>
</Layout>


