---
export interface Props {
  href?: string;
  variant?: "primary" | "secondary" | "teal" | "amethyst";
  size?: "sm" | "md" | "lg" | "get-in-touch";
  external?: boolean;
  ariaLabel?: string;
}

const {
  href,
  variant = "primary",
  size = "md",
  external = false,
  ariaLabel,
} = Astro.props;


const VARIANT: Record<
  NonNullable<Props["variant"]>,
  { bg: string; color: string; hover: string; iconColor: string }
> = {
  teal:      { bg: "#48E9CE", color: "#111827", hover: "filter: brightness(0.95);", iconColor: "#111827" },
  amethyst:  { bg: "#4B00E7", color: "#FFFFFF", hover: "filter: brightness(1.1);",  iconColor: "#FFFFFF" },
  primary:   { bg: "#4B00E7", color: "#FFFFFF", hover: "filter: brightness(1.1);",  iconColor: "#FFFFFF" },
  secondary: { bg: "#D1D5DB", color: "#111827", hover: "filter: brightness(0.95);", iconColor: "#111827" },
};

const { bg, color, hover, iconColor } = VARIANT[variant];

const SIZE: Record<NonNullable<Props["size"]>, string> = {
  sm: "padding: 8px 16px; height: 40px;",
  md: "padding: 12px 24px; height: 48px;",
  lg: "padding: 16px 32px; height: 56px;",
  "get-in-touch": "padding: 12px 24px; height: 48px; width: 205px;",
};

const baseStyle = `
  display: inline-flex;
  align-items: center;
  gap: 10px;
  border-radius: 1px;
  font-family: "Keep Calm", sans-serif;
  font-weight: 500;
  font-style: normal;
  font-size: 20px;
  line-height: 100%;
  letter-spacing: 0%;
  text-decoration: none;
  transition: filter 0.15s ease, transform 0.05s ease;
  background-color: ${bg};
  color: ${color};
  ${SIZE[size]}
`;

const commonA11y = `
  outline: none;
`;
---

{href ? (
  <a
    href={href}
    target={external ? "_blank" : undefined}
    rel={external ? "noopener noreferrer" : undefined}
    aria-label={ariaLabel}
    style={`${baseStyle} ${commonA11y}`}
    onmouseover={`this.style.cssText='${baseStyle}${commonA11y}${hover}'`}
    onmouseout={`this.style.cssText='${baseStyle}${commonA11y}'`}
    onmousedown={`this.style.transform='translateY(1px)'`}
    onmouseup={`this.style.transform='none'`}
  >
    <span><slot /></span>
    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M6 12L10 8L6 4" stroke={iconColor} stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </a>
) : (
  <button
    type="button"
    aria-label={ariaLabel}
    style={`${baseStyle} ${commonA11y}; border: none; cursor: pointer;`}
    onmouseover={`this.style.cssText='${baseStyle}${commonA11y}${hover}; border: none; cursor: pointer;'`}
    onmouseout={`this.style.cssText='${baseStyle}${commonA11y}; border: none; cursor: pointer;'`}
    onmousedown={`this.style.transform='translateY(1px)'`}
    onmouseup={`this.style.transform='none'`}
  >
    <span><slot /></span>
    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M6 12L10 8L6 4" stroke={iconColor} stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
  </button>
)}
